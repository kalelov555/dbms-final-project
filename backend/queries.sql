CREATE TABLE BOOKS(
  id NUMBER,
  bookName VARCHAR(100),
  author VARCHAR(100),
  description VARCHAR(1000),
  genre VARCHAR(100),
  img VARCHAR(300)
)
DROP TABLE BOOKS;

INSERT INTO BOOKS VALUES(1, 'IT ENDS WITH US', 'by Colleen Hoover', 'A battered wife raised in a violent home attempts to halt the cycle of abuse.' ,'Romance novel, Fiction, Contemporary romance', 'https://storage.googleapis.com/du-prd/books/images/9781501110375.jpg');
INSERT INTO BOOKS VALUES(2, 'WHERE THE CRAWDADS SING', 'by Delia Owens', 'In a quiet town on the North Carolina coast in 1969, a young woman who survived alone in the marsh becomes a murder suspect.', 'Novel, Mystery, Bildungsroman, Literary fiction', 'https://storage.googleapis.com/du-prd/books/images/9780735219090.jpg');
INSERT INTO BOOKS VALUES(3,'SEA OF TRANQUILITY', 'by Emily St. John Mandel', 'A detective investigating in the wilderness discovers that his actions might affect the timeline of the universe.', 'Science fiction', 'https://storage.googleapis.com/du-prd/books/images/9780593321447.jpg');
INSERT INTO BOOKS VALUES(4, 'VERITY', 'by Colleen Hoover', 'Lowen Ashleigh is hired by the husband of an injured writer to complete her popular series and uncovers a horrifying truth.', 'Novel, Thriller, Romance novel, Fiction, Suspense', 'https://storage.googleapis.com/du-prd/books/images/9781791392796.jpg');
INSERT INTO BOOKS VALUES(5, 'RUN, ROSE, RUN', 'by Dolly Parton and James Patterson', 'A singer-songwriter goes to Nashville seeking stardom but is followed by her dark past.', 'Thriller, Suspense, Southern Fiction', 'https://storage.googleapis.com/du-prd/books/images/9780759554344.jpg');
INSERT INTO BOOKS VALUES(6, 'BITTERSWEET', 'by Susan Cain', 'The author of “Quiet” suggests ways to embrace loss and suffering within ourselves and others.', 'Thriller, Suspense, Domestic Fiction', 'https://storage.googleapis.com/du-prd/books/images/9780451499783.jpg');
INSERT INTO BOOKS VALUES(7, 'RECESSIONAL', 'by David Mamet', 'The Pulitzer Prize-winning playwright lambastes liberal politics, cancel culture and other things he finds objectionable.', 'Historical Fiction, Saga, Adventure fiction' , 'https://storage.googleapis.com/du-prd/books/images/9780063158993.jpg');
INSERT INTO BOOKS VALUES(8, 'THE BODY KEEPS THE SCORE', 'by Bessel van der Kolk', 'How trauma affects the body and mind, and innovative treatments for recovery.', 'Self-help book', 'https://storage.googleapis.com/du-prd/books/images/9780670785933.jpg');
INSERT INTO BOOKS VALUES(9, 'NOWHERE FOR VERY LONG', 'by Brianna Madia', 'A young woman and her companions travel the deserts of the American West in an orange van.', 'Adventure Fiction','https://storage.googleapis.com/du-prd/books/images/9780063047983.jpg');
INSERT INTO BOOKS VALUES(10, 'BETWEEN TWO KINGDOMS', 'by Suleika Jaouad', 'The writer of the New York Times column “Life, Interrupted” chronicles her fight with cancer and an impactful road trip.', 'Biography, Autobiography', 'https://storage.googleapis.com/du-prd/books/images/9780399588587.jpg');
INSERT INTO BOOKS VALUES(11, 'RUN, ROSE, RUN', 'by Dolly Parton and James Patterson', 'A singer-songwriter goes to Nashville seeking stardom but is followed by her dark past.', 'Thriller, Suspense, Southern Fiction', 'https://storage.googleapis.com/du-prd/books/images/9780759554344.jpg');
INSERT INTO BOOKS VALUES(12, 'SEA OF TRANQUILITY', 'by Emily St. John Mandel', 'A detective investigating in the wilderness discovers that his actions might affect the timeline of the universe.','Science fiction', 'https://storage.googleapis.com/du-prd/books/images/9780593321447.jpg');
INSERT INTO BOOKS VALUES(13, 'TIME IS A MOTHER', 'by Ocean Vuong', 'A second collection of poems by the MacArthur fellow and author of “On Earth We’re Briefly Gorgeous.”', 'Poetry', 'https://storage.googleapis.com/du-prd/books/images/9780593300237.jpg');
INSERT INTO BOOKS VALUES(14, 'THE CANDY HOUSE', 'by Jennifer Egan', 'In a follow-up to “A Visit From the Goon Squad,” a new technology gives the potential to save and share every memory one has ever had.', 'Psychological Fiction', 'https://storage.googleapis.com/du-prd/books/images/9781476716763.jpg');
INSERT INTO BOOKS VALUES(15, 'THE PARIS APARTMENT', 'by Lucy Foley', 'Jess has suspicions about her half-brother’s neighbors when he goes missing.', 'Fiction, Thriller', 'https://storage.googleapis.com/du-prd/books/images/9780063003057.jpg');
INSERT INTO BOOKS VALUES(16, 'BITTERSWEET', 'by Susan Cain', 'The author of “Quiet” suggests ways to embrace loss and suffering within ourselves and others.', 'Thriller, Suspense, Domestic Fiction', 'https://storage.googleapis.com/du-prd/books/images/9780451499783.jpg');
INSERT INTO BOOKS VALUES(17, 'RECESSIONAL', 'by David Mamet', 'The Pulitzer Prize-winning playwright lambastes liberal politics, cancel culture and other things he finds objectionable.', 'Historical Fiction, Saga, Adventure fiction, Domestic Fiction' ,'https://storage.googleapis.com/du-prd/books/images/9780063158993.jpg');
INSERT INTO BOOKS VALUES(18, 'NOWHERE FOR VERY LONG', 'by Brianna Madia', 'A young woman and her companions travel the deserts of the American West in an orange van.', 'Adventure Fiction' ,'https://storage.googleapis.com/du-prd/books/images/9780063047983.jpg');
INSERT INTO BOOKS VALUES(19, 'THE STORYTELLER', 'by Dave Grohl', 'A memoir by the musician known for his work with Foo Fighters and Nirvana.', 'Novel, Psychological Fiction', 'https://storage.googleapis.com/du-prd/books/images/9780063076099.jpg');
INSERT INTO BOOKS VALUES(20, 'CRYING IN H MART', 'by Michelle Zauner', 'The daughter of a Korean mother and Jewish-American father, and leader of the indie rock project Japanese Breakfast, describes creating her own identity after losing her mother to cancer.', 'Biography, Autobiography','https://storage.googleapis.com/du-prd/books/images/9780525657743.jpg');
INSERT INTO BOOKS VALUES(21, 'IT ENDS WITH US', 'by Colleen Hoover', 'A battered wife raised in a violent home attempts to halt the cycle of abuse.', 'Romance novel, Fiction, Contemporary romance', 'https://storage.googleapis.com/du-prd/books/images/9781501110375.jpg');
INSERT INTO BOOKS VALUES(22, 'WHERE THE CRAWDADS SING', 'by Delia Owens', 'In a quiet town on the North Carolina coast in 1969, a young woman who survived alone in the marsh becomes a murder suspect.','Novel, Mystery, Bildungsroman, Literary fiction', 'https://storage.googleapis.com/du-prd/books/images/9780735219090.jpg');
INSERT INTO BOOKS VALUES(23, 'VERITY', 'by Colleen Hoover', 'Lowen Ashleigh is hired by the husband of an injured writer to complete her popular series and uncovers a horrifying truth.','Novel, Thriller, Romance novel, Fiction, Suspense', 'https://storage.googleapis.com/du-prd/books/images/9781791392796.jpg');
INSERT INTO BOOKS VALUES(24, 'THE SEVEN HUSBANDS OF EVELYN HUGO', 'by Taylor Jenkins Reid', 'A movie icon recounts stories of her loves and career to a struggling magazine writer.', 'Novel, Romance novel, Historical Fiction, Psychological Fiction', 'https://storage.googleapis.com/du-prd/books/images/9781501161933.jpg');
INSERT INTO BOOKS VALUES(25, 'UGLY LOVE', 'by Colleen Hoover', 'A casual sexual relationship between Tate and Miles becomes more complicated than they expected.', 'Novel, Romance novel, Fiction','https://storage.googleapis.com/du-prd/books/images/9781476753195.jpg');
INSERT INTO BOOKS VALUES(26, 'THE BODY KEEPS THE SCORE', 'by Bessel van der Kolk', 'How trauma affects the body and mind, and innovative treatments for recovery.', 'Self-help', 'https://storage.googleapis.com/du-prd/books/images/9780670785933.jpg');
INSERT INTO BOOKS VALUES(27, 'BETWEEN TWO KINGDOMS', 'by Suleika Jaouad', 'The writer of the New York Times column “Life, Interrupted” chronicles her fight with cancer and an impactful road trip.', 'Biography, Autobiography', 'https://storage.googleapis.com/du-prd/books/images/9780399588587.jpg');
INSERT INTO BOOKS VALUES(28, 'PANDORAS JAR', 'by Natalie Haynes', 'A re-examination of Greek myths and their female characters through a woman’s perspective.', 'Fiction, Fairy tale','https://storage.googleapis.com/du-prd/books/images/9780063139466.jpg');
INSERT INTO BOOKS VALUES(29, 'EDUCATED', 'by Tara Westover', 'The daughter of survivalists, who is kept out of school, educates herself enough to leave home for university.','Biography, Autobiography', 'https://storage.googleapis.com/du-prd/books/images/9780399590504.jpg');
INSERT INTO BOOKS VALUES(30, 'ALL ABOUT LOVE', 'by bell hooks', 'The late feminist icon explores the causes of a polarized society and the meaning of love.', 'Creative nonfiction','https://storage.googleapis.com/du-prd/books/images/9780060959470.jpg');
INSERT INTO BOOKS VALUES(31, 'RIVER', 'by Erin Hunter', 'The first book in the Warriors: A Starless Clan series. Discover what unfolds after the events of "The Broken Code."','Novel, Young adult fiction', 'https://storage.googleapis.com/du-prd/books/images/9780063050082.jpg');
INSERT INTO BOOKS VALUES(32, 'WONDER', 'by R.J. Palacio', 'A boy with a facial deformity starts school.', 'Novel, Fiction, Childrens literature','https://storage.googleapis.com/du-prd/books/images/9780375899881.jpg');
INSERT INTO BOOKS VALUES(33, 'REFUGEE', 'by Alan Gratz', 'Three children in three different conflicts look for safe haven.', 'Novel, Historical Fiction','https://storage.googleapis.com/du-prd/books/images/9780545880831.jpg');
INSERT INTO BOOKS VALUES(34, 'WITCHLINGS', 'by Claribel A. Ortega', 'Three Witchlings have three weeks to find and kill the deadly Nightbeast or lose their magic forever.', 'Middle grade fantasy','https://storage.googleapis.com/du-prd/books/images/9781338745528.jpg');
INSERT INTO BOOKS VALUES(35, 'DAUGHTER OF THE DEEP', 'by Rick Riordan', 'Ana Dakkar faces the weekend trials at the Harding-Pencroft Academy.', 'Young adult fiction, Science fiction','https://storage.googleapis.com/du-prd/books/images/9781368077927.jpg');
INSERT INTO BOOKS VALUES(36, 'HOW TO CATCH THE EASTER BUNNY', 'by Adam Wallace and Andy Elkerton', 'The Easter Bunny avoids traps in order to deliver eggs and candy.', 'Fiction','https://storage.googleapis.com/du-prd/books/images/9781492638179.jpg');
INSERT INTO BOOKS VALUES(37, 'NANA LOVES YOU MORE', 'by Jimmy Fallon. Illustrated by Miguel Ordóñez', 'The depth of a Nanas love runs deep.', 'Childrens literature','https://storage.googleapis.com/du-prd/books/images/9781250823946.jpg');
INSERT INTO BOOKS VALUES(38, 'PETE THE CAT: BIG EASTER ADVENTURE', 'by James Dean and Kimberly Dean', 'A certain rabbit needs Petes help.', 'Fiction', 'https://storage.googleapis.com/du-prd/books/images/9780062198679.jpg');
INSERT INTO BOOKS VALUES(39, 'I COLOR MYSELF DIFFERENT', 'by Colin Kaepernick. Illustrated by Eric Wilkerson', 'Colin Kaepernick’s moving true story of identity, race and self-love.', 'Childrens literature, Childrens non-fiction literatures','https://storage.googleapis.com/du-prd/books/images/9781338789621.jpg');
INSERT INTO BOOKS VALUES(40, 'THE GOOD EGG PRESENTS: THE GREAT EGGSCAPE!', 'by Jory John. Illustrated by Pete Oswald', 'Good Egg and his pals escape their carton!', 'Fiction','https://storage.googleapis.com/du-prd/books/images/9780062975676.jpg');
INSERT INTO BOOKS VALUES(41, 'WINGS OF FIRE', 'by Tui T. Sutherland', 'Only the five dragonets of destiny can unite the seven warring dragon tribes.', 'Childrens fantasy novel','https://storage.googleapis.com/du-prd/books/images/9780545349215.jpg');
INSERT INTO BOOKS VALUES(42, 'DIARY OF A WIMPY KID', 'written and illustrated by Jeff Kinney', 'The travails and challenges of adolescence.', 'Young adult fiction, Humor, Comedy, Diary fiction','https://storage.googleapis.com/du-prd/books/images/9781419711329.jpg');
INSERT INTO BOOKS VALUES(43, 'HARRY POTTER', 'by J.K. Rowling', 'A wizard hones his conjuring skills in the service of fighting evil.', 'Novel, Thriller, Mystery','https://storage.googleapis.com/du-prd/books/images/9780590353427.jpg');
INSERT INTO BOOKS VALUES(44, 'A GOOD GIRLS GUIDE TO MURDER', 'by Holly Jackson', 'Pippa Fitz-Amobi solves murderous crimes.', 'Young adult fiction, Thriller, Mystery','https://storage.googleapis.com/du-prd/books/images/9780593379851.jpg');
INSERT INTO BOOKS VALUES(45, 'CAPTAIN UNDERPANTS', 'written and illustrated by Dav Pilkey', 'Boys and their principal fight evil.', 'Novel, Humor, Fiction','https://storage.googleapis.com/du-prd/books/images/9780545175340.jpg');
INSERT INTO BOOKS VALUES(46, 'A MAGIC STEEPED IN POISON', 'by Judy I. Lin', 'In an attempt to save her sisters life, Ning takes part in a cutthroat magical competition.', 'Fiction','https://storage.googleapis.com/du-prd/books/images/9781250872111.jpg');
INSERT INTO BOOKS VALUES(47, 'ONE OF US IS LYING', 'by Karen M. McManus', 'For five students, a detour into detention ends in murder.', 'Mystery, Young adult fiction','https://storage.googleapis.com/du-prd/books/images/9781524714680.jpg');
INSERT INTO BOOKS VALUES(48, 'GALLANT', 'by V.E. Schwab', 'Olivia uncovers long-buried family secrets after arriving at Gallant.', 'Fantasy Fiction','https://storage.googleapis.com/du-prd/books/images/9780062835772.jpg');
INSERT INTO BOOKS VALUES(49, 'SHE GETS THE GIRL', 'by Rachael Lippincott and Alyson Derrick', 'Two young women, Alex and Molly, attend the University of Pittsburgh with the intention of reinventing themselves.', 'Young adult fiction','https://storage.googleapis.com/du-prd/books/images/9781534493797.jpg');
INSERT INTO BOOKS VALUES(50, 'HOTEL MAGNIFIQUE', 'by Emily J. Taylor', 'Two sisters apply and get jobs at the legendary Hotel Magnifique, which changes locations daily, only to find that they are trapped.', 'Fictions','https://storage.googleapis.com/du-prd/books/images/9780593404515.jpg');

select * from books;
delete from books where id=88;

CREATE TABLE DMLS(
    c_insert VARCHAR(10),
    c_delete VARCHAR(10),
    c_update VARCHAR(10)
)
INSERT INTO DMLS
VALUES('INSERT', 'DELETE', 'UPDATE');

CREATE TABLE BOOKS_TRIGGERS_LOG(
  triggered_time DATE,
  trigg_name VARCHAR(50),
  v_user VARCHAR(50)
)

drop PROCEDURE LOGBOOKS;

CREATE OR REPLACE PROCEDURE create_table_with_triggs(p_name IN VARCHAR2) IS
v_create_dml_triggs VARCHAR(15000) := '
    CREATE OR REPLACE TRIGGER dml_' || p_name || '_trigg
    AFTER UPDATE OR DELETE OR INSERT ON ' || p_name || '
    FOR EACH ROW
    DECLARE
        v_user VARCHAR(10);
        v_insert VARCHAR(10);
        v_delete VARCHAR(10);
        v_update VARCHAR(10);
    BEGIN
        SELECT user INTO v_user
        FROM dual;
        
        SELECT c_insert INTO v_insert
        FROM dmls;
        
        SELECT c_delete INTO v_delete
        FROM dmls;
        
        SELECT c_update INTO v_update
        FROM dmls;
        
        IF DELETING THEN 
        INSERT INTO ' || p_name || '_triggers_log
        VALUES(SYSDATE, v_delete, v_user);
        
        ELSIF INSERTING THEN
        INSERT INTO ' || p_name || '_triggers_log
        VALUES(SYSDATE, v_insert, v_user);
        
        ELSIF UPDATING THEN
        INSERT INTO ' || p_name || '_triggers_log
        VALUES(SYSDATE, v_update, v_user);
        END IF;
    END;';
BEGIN
    EXECUTE IMMEDIATE v_create_dml_triggs;
END;

select * from BOOKS;
delete from books where id = 65;


-- CREATE OR REPLACE PROCEDURE insert_into_books(
--     v_id IN NUMBER,
--     v_bookName IN VARCHAR2,
--     v_author IN VARCHAR2,
--     v_description IN VARCHAR2,
--     v_genre IN VARCHAR2,
--     v_img IN VARCHAR2
-- ) IS
-- BEGIN
--     EXECUTE IMMEDIATE 
--     'INSERT INTO BOOKS VALUES (' ||
--     v_id || ',' || v_bookName || ',' ||  v_author || ',' || v_description || ',' || v_genre || ',' || v_img || ');';
-- END;


select * from books where genre like '%Novel%';
